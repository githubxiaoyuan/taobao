"use strict";!function(){var e=document.querySelector(".reg-form"),n=e.querySelector(".reg-username"),t=e.querySelector(".user-email"),i=e.querySelector(".reg-password"),l=e.querySelector(".reg-rep-password"),r=document.getElementById("regSubmitBtn"),a=/^[\u4E00-\u9FA5A-Za-z0-9_]{6,16}$/,s=/(?=.*([a-zA-Z].*))(?=.*[0-9].*)[a-zA-Z0-9-*/+.~!@#$%^&*()]{6,20}$/,u=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,m=!1,c=!1,o=!1,x=!1;r.onclick=function(e){if((e=e||window.event).preventDefault?e.preventDefault():returnValue=!1,!a.test(n.value))return n.nextElementSibling.innerText="用户名只能是数字、字母、汉字和下划线组合，长度6-16位！",n.nextElementSibling.className="tip error",m=!1,n.focus();if(n.nextElementSibling.innerText="恭喜你，该用户名可以被使用 √",n.nextElementSibling.className="tip current",m=!0){if(!u.test(t.value))return t.nextElementSibling.innerText="请输入正确的邮箱！",t.nextElementSibling.className="tip error",c=!1,t.focus();t.nextElementSibling.innerText="恭喜你，该邮箱可以被使用 √",t.nextElementSibling.className="tip current",c=!0}if(m&&c){if(!s.test(i.value))return i.nextElementSibling.innerText="密码必须同时包含字母和数字，可以有特殊字符，长度8-16位！",i.nextElementSibling.className="tip error",o=!1,i.focus();i.nextElementSibling.innerText="密码格式正确 √",i.nextElementSibling.className="tip current",o=!0}if(m&&c&&o){if(i.value!==l.value)return l.nextElementSibling.innerText="两次输入密码不一致 √",l.nextElementSibling.className="tip error",x=!1,l.focus();l.nextElementSibling.innerText="两次输入密码一致 √",l.nextElementSibling.className="tip current",x=!0}m&&c&&o&&x&&(e={username:n.value,password:i.value,email:t.value},$.ajax({url:"/api/registered",method:"POST",data:e,success:function(n){layui.use("layer",function(){var e=layui.layer;if(1!==n.status)return e.msg(n.message);e.msg(n.message),setTimeout(function(){return location.href="./login.html"},1500)})},error:function(){layui.use("layer",function(){layui.layer.msg("注册失败，请检查网络设置！")})}}))},n.onchange=function(){a.test(n.value)?$.ajax({url:"/api/registered/user",method:"GET",data:{username:n.value},success:function(e){if(1!==e.status)return n.nextElementSibling.innerText="该用户名已被注册！",n.nextElementSibling.className="tip error",void(m=!1);n.nextElementSibling.innerText="恭喜你，该用户名可以被使用 √",n.nextElementSibling.className="tip current",m=!0}}):(n.nextElementSibling.innerText="用户名只能是数字、字母、汉字和下划线组合，长度6-16位！",n.nextElementSibling.className="tip error",m=!1)},t.onchange=function(){u.test(t.value)?$.ajax({url:"/api/registered/email",method:"GET",data:{email:t.value},success:function(e){if(1!==e.status)return t.nextElementSibling.innerText="该邮箱已被注册！",t.nextElementSibling.className="tip error",void(c=!1);t.nextElementSibling.innerText="恭喜你，该邮箱可以被使用 √",t.nextElementSibling.className="tip current",c=!0}}):(t.nextElementSibling.innerText="请输入正确的邮箱格式！",t.nextElementSibling.className="tip error",c=!1)},i.onchange=function(){o=s.test(i.value)?(i.nextElementSibling.innerText="密码格式正确 √",i.nextElementSibling.className="tip current",!0):(i.nextElementSibling.innerText="密码必须同时包含字母和数字，可以有特殊字符，长度8-16位！",!(i.nextElementSibling.className="tip error"))},l.onchange=function(){x=i.value===l.value?(l.nextElementSibling.innerText="两次输入密码一致 √",l.nextElementSibling.className="tip current",!0):(l.nextElementSibling.innerText="两次输入密码不一致 √",!(l.nextElementSibling.className="tip error"))},e.oninput=function(){n.value.trim()&&t.value.trim()&&i.value.trim()&&l.value.trim()?(r.disabled=!1,r.style.opacity="1"):(r.disabled=!0,r.style.opacity=".5")}}();