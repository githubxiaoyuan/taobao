"use strict";function filterSubMenu(){for(var t=document.querySelectorAll(".filter-items"),o=document.querySelectorAll(".filter-sub-item"),e=0;e<t.length;e++)t[e].setAttribute("data-index",e),o[e].setAttribute("data-index",e),t[e].onmouseover=function(){for(var e=0;e<o.length;e++)o[e].style.display="none",t[e].style.backgroundColor="#fff",t[e].querySelector(".icon-ai-arrow-down").style.display="inline-block",t[e].querySelector(".icon-jiantoushang-copy").style.display="none";this.style.backgroundColor="#E2E2E2",this.querySelector(".icon-ai-arrow-down").style.display="none",this.querySelector(".icon-jiantoushang-copy").style.display="inline-block",o[this.getAttribute("data-index")].style.display="block"},t[e].onmouseout=function(){this.style.backgroundColor="#fff",this.querySelector(".icon-ai-arrow-down").style.display="inline-block",this.querySelector(".icon-jiantoushang-copy").style.display="none",o[this.getAttribute("data-index")].style.display="none"},o[e].onmouseover=function(){this.style.display="block",this.parentNode.parentNode.querySelectorAll(".icon-ai-arrow-down")[this.getAttribute("data-index")].style.display="none",this.parentNode.parentNode.querySelectorAll(".icon-jiantoushang-copy")[this.getAttribute("data-index")].style.display="inline-block",t[this.getAttribute("data-index")].style.backgroundColor="#E2E2E2"},o[e].onmouseout=function(){this.style.display="none",this.parentNode.parentNode.querySelectorAll(".icon-ai-arrow-down")[this.getAttribute("data-index")].style.display="inline-block",this.parentNode.parentNode.querySelectorAll(".icon-jiantoushang-copy")[this.getAttribute("data-index")].style.display="none",t[this.getAttribute("data-index")].style.backgroundColor="#fff"};for(var r=document.querySelectorAll(".multi-select"),e=0;e<r.length;e++)r[e].onclick=function(){var e=document.querySelector(".main-nav-groups").querySelectorAll(".select"),t=this.parentNode.parentNode.querySelectorAll(".select"),o=this.parentNode.parentNode,s=document.querySelector(".main-nav-groups").querySelectorAll(".nav-row");if("0"==this.getAttribute("data-flag")){for(var i=0;i<s.length-1;i++)s[i].className="nav-row",r[i].setAttribute("data-flag","0"),s[i].querySelector(".nav-body-items").scrollTop=0;for(var a=0;a<e.length;a++)e[a].style.display="none";o.className="nav-row expand-mode";for(var l=0;l<t.length;l++)t[l].style.display="inline-block";this.setAttribute("data-flag","1")}else{o.className="nav-row";for(l=0;l<t.length;l++)t[l].style.display="none";this.setAttribute("data-flag","0")}};for(var s=document.querySelector(".main-nav-groups").querySelectorAll(".cancel-multi-select"),e=0;e<s.length;e++)s[e].onclick=function(){for(var e=this;-1===e.className.indexOf("nav-row");)e=e.parentNode;e.className="nav-row",e.querySelector(".multi-select").setAttribute("data-flag","0"),e.querySelector(".nav-body-items").scrollTop=0;for(var t=e.querySelectorAll(".select"),o=0;o<t.length;o++)t[o].style.display="none"};for(var i=document.querySelector(".main-nav-groups").getElementsByClassName("item"),e=0;e<i.length;e++)i[e].onclick=function(){if(this.querySelector(".text")){for(var e=this;-1===e.className.indexOf("nav-row");)e=e.parentNode;"1"==(e=e.querySelector(".multi-select")).getAttribute("data-flag")&&("0"==this.querySelector(".text").getAttribute("select-flag")?(this.querySelector(".select").style.backgroundPosition="-69px -423px",this.querySelector(".text").setAttribute("select-flag","1")):(this.querySelector(".select").style.backgroundPosition="-48px -423px",this.querySelector(".text").setAttribute("select-flag","0")))}};document.querySelector(".price-sort").onmouseover=function(){}}filterSubMenu();var keyword=decodeURI(location.search.substr(location.search.indexOf("=")+1));function goodsSearch(){$(".search-btn").on("click",function(){return $(".search-input").val().trim()?location.href="./goodslist.html?keyword="+$(".search-input").val().trim():location.href="./goodslist.html"}),$(".search-input").on("keyup",function(e){if(13===e.keyCode)return $(".search-input").val().trim()?location.href="./goodslist.html?keyword="+$(".search-input").val().trim():location.href="./goodslist.html"})}function getRandom(e,t){return Math.floor(Math.random()*(t-e+1))+e}keyword.trim()?$(".search-input").val(keyword.trim()):$(".search-input").val(""),goodsSearch(),layui.use(["laypage","layer"],function(){var s=layui.laypage,o=layui.layer,u=document.getElementById("goodsItemsBox"),g=document.getElementById("hotGoodsBox"),h=[];function i(e,t){s.render({elem:"goodsPage",count:e,limit:t,layout:["prev","page","next","skip"],jump:function(e,t){for(var o,s,i=h.slice(48*(e.curr-1),48*e.curr),a=[],l=0;l<i.length;l++)-1!==i[l].goods_title.indexOf(keyword)&&(s=new RegExp(keyword,"gi"),s=i[l].goods_title.replace(s,'<span class="s-keyword">'+keyword+"</span>")),o='<div class="goods-item"><div class="goods-pic-wrap"><a href="./item.html?id='+i[l].id+'" target="_blank"><img src="'+i[l].goods_img+'" alt=""></a></div><div class="goods-info"><div class="line line1 clearfix"><div class="goods-price-box"><span>￥</span><strong class="goods-price">'+i[l].goods_price.toFixed(2)+'</strong></div><div class="pay-number">'+i[l].goods_sales+'人付款</div><div class="goods-service-icon"></div></div><div class="line line2 clearfix"><a href="./item.html?id='+i[l].id+'" class="goods-title-dec" target="_blank">'+s+'</a></div><div class="line line3 clearfix"><div class="goods-shop"><a href="./item.html?id='+i[l].id+'" class="shop-link" target="_blank"><span class="shop-icon"></span><span class="shop-name">'+i[l].shop_name+'</span></a></div><div class="location">广东 深圳</div></div><div class="line line4 clearfix"><div class="shop-honors"><ul class="clearfix"></ul></div><div class="wangwang-icon"><a href="javascript:;"></a></div></div></div></div>',a.push(o);u.innerHTML=a.join("");for(var r,n=[],c=[],l=0;l<16;l++){for(var d=getRandom(0,h.length-1);-1!==n.indexOf(d);)d=getRandom(0,h.length-1);n.push(d),r=' <li><div class="hot-goods-img-wrap"><a href="./item.html?id='+h[d].id+'" target="_blank"><img src="'+h[d].goods_img+'" alt=""></a></div><div class="hot-goods-info clearfix"><div class="hot-goods-price"><a href="./item.html?id='+h[d].id+'" target="_blank"><em>¥</em><strong>'+h[d].goods_price.toFixed(2)+'</strong></a></div><div class="hot-goods-sales"><a href="./item.html?id='+h[d].id+'" target="_blank">销量：<span>'+h[d].goods_sales+'</span></a></div></div><div class="hot-goods-title-mask"><a href="./item.html?id='+h[d].id+'" target="_blank"><h3 class="title">'+h[d].goods_title+"</h3></a></div></li>",c.push(r)}g.innerHTML=c.join("")}});var o=document.querySelector(".goods-page").querySelector(".layui-laypage-skip"),t=document.createTextNode("共 "+Math.ceil(e/t)+" 页，");o.insertBefore(t,o.childNodes[0])}$.ajax({url:"/api/goodslist",method:"GET",data:{keyword:keyword},success:function(e){if(1!==e.status)return console.log(e.message);h=e.data,i(e.total,e.limit)}}),$(".sort-module .sort-btn").on("click",function(){$.each($(".sort-module .sort-btn"),function(e,t){$(t).removeClass("activity")}),$(".sort-module .sort-price").removeClass("activity"),$(this).addClass("activity"),$(this).hasClass("sort-default-btn")&&$.ajax({url:"/api/goodslist",method:"GET",data:{keyword:keyword},success:function(e){if(1!==e.status)return console.log(e.message);h=e.data,i(e.total,e.limit)}}),$(this).hasClass("sort-sales-btn")&&$.ajax({url:"/api/goodslist/sales",method:"GET",data:{keyword:keyword},success:function(e){if(1!==e.status)return console.log(e.message);h=e.data,i(e.total,e.limit)}}),$(this).hasClass("sort-credit-btn")&&$.ajax({url:"/api/goodslist/credit",method:"GET",data:{keyword:keyword},success:function(e){if(1!==e.status)return console.log(e.message);h=e.data,i(e.total,e.limit)}}),$(this).hasClass("sort-price-asc")&&($(".sort-module .sort-price").html($(this).text()+'<i class="iconfont icon-ai-arrow-down"></i>').addClass("activity"),$.ajax({url:"/api/goodslist/price_asc",method:"GET",data:{keyword:keyword},success:function(e){if(1!==e.status)return console.log(e.message);h=e.data,i(e.total,e.limit)}})),$(this).hasClass("sort-price-desc")&&($(".sort-module .sort-price").html($(this).text()+'<i class="iconfont icon-ai-arrow-down"></i>').addClass("activity"),$.ajax({url:"/api/goodslist/price_desc",method:"GET",data:{keyword:keyword},success:function(e){if(1!==e.status)return console.log(e.message);h=e.data,i(e.total,e.limit)}}))}),$(".sort-module .price-submit-btn").on("click",function(){var e=parseFloat($(".sort-module .input-price-filter1").val().trim()),t=parseFloat($(".sort-module .input-price-filter2").val().trim());if(!e||!t||t<e)return o.msg("请输入正确的价格区间！");$.ajax({url:"/api/goodslist/price_range",method:"GET",data:{price1:e,price2:t,keyword:keyword},success:function(e){return 1!==e.status?console.log(e.message):0<e.data.length?(h=e.data,void i(e.total,e.limit)):o.msg("没有查询到相应结果！")}})})});